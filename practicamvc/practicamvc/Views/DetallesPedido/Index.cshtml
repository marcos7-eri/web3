@model IEnumerable<practicamvc.Models.DetallePedidoModel>
@using Microsoft.AspNetCore.Mvc.Rendering
@{
    ViewData["Title"] = "Detalles de pedido";
}

<style>
    h2 {
        font-weight: 700;
        color: #2c3e50;
    }

    .table-container {
        background: #fff;
        padding: 2rem;
        border-radius: 15px;
        box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    }

    .btn-primary, .btn-outline-secondary, .btn-link {
        border-radius: 25px;
        padding: 8px 18px;
        font-weight: 600;
        text-transform: uppercase;
    }

    .btn-primary {
        background: linear-gradient(135deg, #3498db, #2c80b4);
        border: none;
        color: #fff;
    }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 18px rgba(0,0,0,0.15);
        }

    .btn-warning {
        border-radius: 25px;
        padding: 5px 12px;
    }

    .btn-danger {
        border-radius: 25px;
        padding: 5px 12px;
    }

    .btn-info {
        border-radius: 25px;
        padding: 5px 12px;
    }

    .form-select {
        border-radius: 10px;
    }

    .filter-row {
        margin-bottom: 1rem;
    }
</style>

<div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Detalles de pedido</h2>
    <a asp-action="Create" class="btn btn-primary">Nuevo detalle</a>
</div>

@if (TempData["Ok"] != null)
{
    <div class="alert alert-success">@TempData["Ok"]</div>
}

<form method="get" class="row g-2 filter-row">
    <div class="col-auto">
        <select name="idPedido" class="form-select" asp-items="ViewBag.Pedidos">
            <option value="">-- Filtrar por pedido --</option>
        </select>
    </div>
    <div class="col-auto d-flex gap-2">
        <button class="btn btn-outline-secondary" type="submit">Filtrar</button>
        <a asp-action="Index" class="btn btn-link">Limpiar</a>
    </div>
</form>

<div class="table-container">
    <table class="table table-striped table-hover shadow-sm mb-0">
        <thead class="table-light">
            <tr>
                <th>#</th>
                <th>Pedido</th>
                <th>Cliente</th>
                <th>Producto</th>
                <th class="text-end">Cantidad</th>
                <th class="text-end">Precio unit. (Bs)</th>
                <th class="text-end">Subtotal (Bs)</th>
                <th style="width:190px"></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var d in Model)
            {
                <tr>
                    <td>@d.Id</td>
                    <td>@d.IdPedido</td>
                    <td>@(d.Pedido?.Cliente?.Nombre ?? "—")</td>
                    <td>@d.Producto?.Nombre</td>
                    <td class="text-end">@d.Cantidad</td>
                    <td class="text-end">@d.PrecioUnitario.ToString("N2")</td>
                    <td class="text-end">@((d.Cantidad * d.PrecioUnitario).ToString("N2"))</td>
                    <td class="text-end">
                        <a asp-action="Details" asp-route-id="@d.Id" class="btn btn-sm btn-info text-white">Ver</a>
                        <a asp-action="Edit" asp-route-id="@d.Id" class="btn btn-sm btn-warning">Editar</a>
                        <a asp-action="Delete" asp-route-id="@d.Id" class="btn btn-sm btn-danger">Eliminar</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
